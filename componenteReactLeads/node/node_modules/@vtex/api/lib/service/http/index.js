"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const compose_1 = require("../utils/compose");
const authTokens_1 = require("./middlewares/authTokens");
const cancellationToken_1 = require("./middlewares/cancellationToken");
const cdnNormalizer_1 = require("./middlewares/cdnNormalizer");
const clients_1 = require("./middlewares/clients");
const error_1 = require("./middlewares/error");
const requestStats_1 = require("./middlewares/requestStats");
const setCookie_1 = require("./middlewares/setCookie");
const timings_1 = require("./middlewares/timings");
const vary_1 = require("./middlewares/vary");
exports.createHttpRoute = (Clients, options) => {
    return (handler) => {
        const middlewares = Array.isArray(handler) ? handler : [handler];
        const pipeline = [cancellationToken_1.cancellationToken, requestStats_1.trackIncomingRequestStats, cdnNormalizer_1.cdnNormalizer, vary_1.vary, authTokens_1.authTokens, clients_1.clients(Clients, options), setCookie_1.removeSetCookie, timings_1.timings, error_1.error, ...middlewares];
        return compose_1.compose(pipeline);
    };
};
